첫번째 스프링 개인 프로젝트: SJBoard
==============================

## 1. SJBoard 소개
------------------------------
- SJBoard는 **댓글 및 파일 업로드 기능이 있는 게시판**입니다. 
- 게시물은 누구나 제한 없이 볼 수 있지만 회원 가입 후 **로그인한 사용자만 글을 작성**하고 **게시물을 추천**할 수 있으며 **회원 권한 별로 이용할 수 있는 메뉴를 차별화** 하였습니다. 
- 관리자 권한만이 사용할 수 있는 **관리자 페이지**에서는 **전체 회원 관리 및 기간별 현황 데이터**를 확인할 수 있습니다.

## 2. 제작 동기 
------------------------------
- **게시판**은 모든 웹 애플리케이션에서 필수이자 **기본** 요소입니다. 
- **게시판**은 **신입 Back-End 개발자**라면 반드시 갖추어야 하는 **기본적인 스프링 프레임워크 사용법과 CRUD 기능 구현 능력**을 학습하고 활용하는데 가장 적합하며 추가 응용 및 확장 가능성 또한 많은 요소입니다
- 기본적인 게시물 생성(Create), 등록(Register), 수정(Update), 삭제(Delete) 기능에 **댓글 등록 및 파일 업로드 기능을 추가**함으로써 **기본 CRUD 구현 능력을 심화하고 발전**시킬 수 있습니다. 
- 또한 단순히 게시판 구현으로 끝내지 않고 조금 더 기능을 추가하여 **회원 가입, 로그인, 로그아웃 기능 및 관리자 페이지까지 구현**한다면 웹 애플리케이션에서 기본적으로 요구하는 기능을 좀 더 심도있게 학습하고 활용할 수 있습니다.

## 3. 프로젝트 개발 환경 및 사용 기술
-------------------------------
> ### Front-End 
- JavaScript
- jQuery 3.3.1
- BootStrap 3.3.7

> ### Back-End
- Spring 5.0.7
- JavaSE 1.8
- Maven 2.9
- Tomcat 8.5
- Oracle Express Edition 11g
- HikariCP 5.0.1
- MyBatis 3.5.9
- Lombok 1.18.22

## 4. 프로젝트 제작 기간 (2022/03/02 ~ 2022/03/30 (총 5주 중 실제 프로젝트 작업기간: 19일))
-------------------------------
2022년 3월 한 달 동안 **스프링 공부와 SJBoard 프로젝트를 병행**하였습니다.  
매일 새롭게 공부한 내용들과 프로젝트 중 발생한 에러들은 잊지 않고 나중에 필요하면 찾아볼 수 있도록 **매일 블로그에 개발 일지**로 정리하여 업로드하였습니다.

- [SJBoard 개발일지](https://seojoo21.tistory.com/category/개인프로젝트/%5B스프링%5D%20SJBoard%20개발일지)
- [에러 해결 모음](https://seojoo21.tistory.com/category/에러%20해결%20모음)
- [SJBoard 프로젝트롤 통한 스프링 공부](https://seojoo21.tistory.com/category/Spring%20공부/SJBoard%20프로젝트를%20통한%20스프링%20공부)

> #### 1주차 (2022/03/02~2022/03/06) 
- 03/02 개발 환경 설정 및 프로젝트 기획 및 설계. 게시판 DB 생성 및 게시판 영속 및 비즈니스 계층 CRUD 작업  
- 03/03 BootStrap 무료 템플릿의 HTML/CSS를 프로젝트에 맞게 수정하여 JSP 페이지로 변환. 게시판 프레젠테이션 계층 CRUD 작업 
- 03/04 게시판 페이징 처리 및 검색 처리 기능 구현. 댓글 기능을 위한 영속 계층 CRUD 작업 
- 03/06 댓글 기능 서비스 계층 CRUD 작업 

> #### 2주차 (2022/03/07~2022/03/13) 
- 03/07~03/10 스프링 AOP, 트랜잭션, 파일 업로드 기능 기본 개념 및 예제 학습
- 03/11 프로젝트 내 파일 업로드 구현 설계. 첨부 파일 DB 생성. 첨부파일 영속, 비즈니스, 프레젠테이션 계층 작업
- 03/12~03/13 스프링 웹 시큐리티 기본 개념 및 예제 학습

> #### 3주차 (2022/03/14~2022/03/20) 
- 03/14 스프링 웹 시큐리티 기본 개념 및 예제 학습
- 03/15 회원 정보 DB 생성. 로그인, 로그아웃 기능 영속, 비즈니스, 프레젠테이션 계층 작업
- 03/16 기존 게시판에 스프링 웹 시큐리티 기능 추가
- 03/17 회원 가입 기능 추가 작업
- 03/18 회원 정보 조회, 수정, 탈퇴 기능 작업 
- 03/19 회원 가입 시 아이디 및 사용자 이름 중복 체크 기능 작업. 회원 가입 시 SMTP 서버를 이용한 이메일 인증 번호 전송 기능 작업

> #### 4주차 (2022/03/21~2022/03/27) 
- 03/21 회원 가입 시 이메일 인증 번호 입력 및 일치 여부 확인 기능 작업 
- 03/22 회원 아이디 찾기, 비밀번호 찾기 기능 작업
- 03/23 기존 게시판 기능 보완 (사용자 아이디를 기준으로 게시물 수정 및 삭제 처리를 할 수 있도록 기존 기능 수정)
- 03/24 게시물 추천 기능 구현 설계
- 03/25 게시물 추천 기능 작업 
- 03/26 기존 게시판 기능 보완 (SummerNote 에디터 적용) 

> #### 5주차 (2022/03/28~2022/03/30) 
- 03/28 관리자 페이지 설계. 관리자 페이지 내 회원 목록 조회 페이지 작업
- 03/29 관리자 페이지 내 주간 현황 조회 페이지 작업 (구글 차트 활용)
- 03/30 관리자 페이지 내 기간별 현황 조회 페이지 작업 (구글 차트 활용) 및 코드 정리


## 5. SJBoard 패키지 구조 및 데이터베이스 모델링 
> ### 5-1. 패키지 구조 
<img width="1135" alt="스크린샷 2022-04-02 오전 10 57 05" src="https://user-images.githubusercontent.com/98722435/161361223-ef3acbc4-5db6-4b95-9e29-36d078357975.png">
<img width="604" alt="스크린샷 2022-04-02 오전 10 57 14" src="https://user-images.githubusercontent.com/98722435/161361281-30a3df51-4c01-448d-a572-a63c044af19d.png">

> ### 5-2. 데이터베이스 모델링
<img width="1158" alt="스크린샷 2022-04-02 오후 5 24 08" src="https://user-images.githubusercontent.com/98722435/161374355-199c7995-e4f0-4058-8de6-ffb523216863.png">


## 6. Back-End Function Flow
- 스프링 웹 시큐리티를 이용하여 회원 가입 및 로그인 기능을 구현하였기 때문에 사용자의 권한에 따라 이용할 수 있는 메뉴와 접근할 수 있는 페이지를 차별화하였습니다.

- 특정 페이지의 경우 URL이 노출되어 권한이 없는 사용자가 접근하는 것을 방지하고자 해당 URL 접속 시 사용자의 권한을 사전에 체크할 수 있도록 security-context.xml에는 <security: intercept-url> 태그를, 담당 Controller 내 메서드에는 @PreAuthroize 어노테이션을 사용하였습니다. 

<img width="1041" alt="스크린샷 2022-04-02 오전 11 24 08" src="https://user-images.githubusercontent.com/98722435/161362071-81d41eb8-082b-459e-9ef2-e08ff701e5c8.png">

- 회원 가입 및 로그인 여부와 상관 없이 모든 비회원 및 일반 회원이 접근할 수 있는 홈 페이지와 게시판 페이지의 Function Flow 및 권한에 따른 이용 가능 서비스는 아래와 같습니다.

<img width="1301" alt="스크린샷 2022-04-02 오전 11 25 57" src="https://user-images.githubusercontent.com/98722435/161362157-702a2cf2-c1fc-4e9f-85de-e0b2f9fc6098.png">

- 일반 회원만 접근할 수 있는 회원 정보 페이지의 Function Flow는 아래와 같습니다.  
<img width="419" alt="그림1" src="https://user-images.githubusercontent.com/98722435/161362234-921df967-b8b8-4e83-91e0-00497398ed37.png">

- 관리자만 접근할 수 있는 관리자 페이지의 Function Flow는 아래와 같습니다.  
<img width="463" alt="그림2" src="https://user-images.githubusercontent.com/98722435/161362245-0bc11e5e-c2f5-412b-bc99-c671e48296bd.png">


## 7. 프로젝트 결과물 
> ### Front-End 주요 기능
#### 1. https://startbootstrap.com에서 무료로 배포하는 BootStrap 템플릿을 바탕으로 SJBoard의 필요에 맞게 수정하여 사용
<img width="1578" alt="스크린샷 2022-04-02 오전 11 42 03" src="https://user-images.githubusercontent.com/98722435/161362748-45c16086-e6fc-4ca7-8080-d7d91d11cd1c.png">

#### 2. 게시판 글 작성 및 수정 시 SummerNote 에디터 적용

![ezgif com-gif-maker](https://user-images.githubusercontent.com/98722435/161363639-c6e2a9cc-c938-49a7-8ebd-97babf909199.gif)

> ### Back-End 주요 기능 
#### 1. 회원 가입 
- ##### 1) 회원 가입 시 ID 및 사용자 이름 중복 확인
    - **Ajax 비동기 방식**으로 구현

    ![ezgif com-gif-maker-3](https://user-images.githubusercontent.com/98722435/161366336-4dfa0d3e-0f59-44d1-a9e5-5125aceea654.gif)

- ##### 2) 이메일 인증 번호 전송 및 인증 번호 일치 여부 확인
    - **보안**을 위해 **SecureRandom** 인스턴스로 6자리 난수 생성 
    - **SMTP 서버**를 이용한 인증 번호 이메일 전송 
    - 인증 번호는 생성과 동시에 **세션**에 **저장**되어 사용자 입력값과 비교하여 일치 여부 확인 
    ![ezgif com-gif-maker-4](https://user-images.githubusercontent.com/98722435/161366808-6f557b78-3c5d-43cd-9b91-ceee132a1e3f.gif)

    <img width="300" alt="스크린샷 2022-04-02 오후 2 15 43" src="https://user-images.githubusercontent.com/98722435/161367649-e0b9b17f-876d-414e-b42d-3777dc972330.png">

    
    ![ezgif com-gif-maker-5](https://user-images.githubusercontent.com/98722435/161367747-0347ba29-3349-49ba-b003-cd611644ade5.gif)

- ##### 3) 회원 가입 완료 후 모달창을 이용해 처리 결과를 안내하고 로그인 화면으로 Redirect

![ezgif com-gif-maker-6](https://user-images.githubusercontent.com/98722435/161368133-629b71ff-78c1-4b9e-8408-6ffca05ed800.gif)


#### 2. 로그인
- ##### 1) 아이디 찾기
    - **Ajax 비동기 방식**으로 구현 

    ![ezgif com-gif-maker-7](https://user-images.githubusercontent.com/98722435/161368233-a13900ac-24d3-4fa8-a413-000603cf880e.gif)

- ##### 2) 비밀번호 찾기 
    - 회원 가입 시 가입했던 이메일 주소로 **인증 번호 발송** 

    ![ezgif com-gif-maker-8](https://user-images.githubusercontent.com/98722435/161368660-eab82e54-2a42-4406-a13e-2db86c6730ec.gif)

    - 인증 번호는 생성과 동시에 **세션**에 **저장**되어 사용자 입력값과 비교하여 일치 여부 확인 
    - 비밀 번호 찾기 시 사용자의 비밀 번호 **보안**을 위해 서버에서 임의의 비밀 번호를 생성하여 사용자 이메일로 전송하지 않고, 회원 가입시와 동일하게 비밀 번호 재설정을 위한 인증 번호를 사용자 이메일로 발송하여 **인증 번호 일치 시 사용자가 스스로 비밀 번호를 재설정** 하도록 구현 
    - 비밀번호 재설정 후 로그인 화면으로 **redirect** 처리 

    ![ezgif com-gif-maker-9](https://user-images.githubusercontent.com/98722435/161368774-2029417c-f181-4017-832e-ab12ed5ae2c8.gif)

- ##### 3) 자동 로그인
    - 사용자가 ‘로그인 상태 유지’ 체크 박스를 선택하고 로그인을 하면 ‘remember-me’라는 **쿠키** 생성 및 **DB**에 해당 사용자의 정보가 **저장**
    - 쿠키의 **유효 시간**은 **7일**이므로 7일 이후 해당 사용자의 자동 로그인 정보는 DB에서 삭제

    ![ezgif com-gif-maker-10](https://user-images.githubusercontent.com/98722435/161369243-14ce180f-57db-412e-856a-4239730233f5.gif)

    <img width="660" alt="스크린샷 2022-04-02 오후 3 04 27" src="https://user-images.githubusercontent.com/98722435/161369255-ab0a2214-07a9-4019-bad3-b094973a13a7.png">

   - 자동 로그인을 설정했던 사용자가 **로그아웃**을 하면 DB에 저장되었던 **자동 로그인 정보** 및 **쿠키 삭제**

    ![ezgif com-gif-maker-11](https://user-images.githubusercontent.com/98722435/161369344-5945c281-00d0-4c0b-8b09-9f696efac880.gif)

    <img width="527" alt="스크린샷 2022-04-02 오후 3 07 56" src="https://user-images.githubusercontent.com/98722435/161369365-3eb09a04-80a8-4d49-8fd6-da3a2702c31b.png">


#### 3. 게시판 CRUD
- ##### 1) 게시물 조회, 작성, 등록, 수정, 삭제 
    - 게시물 조회는 누구나 제한 없이 가능 
    - 게시물 **작성**은 **회원**만 가능하므로 로그인 하지 않은 경우 글쓰기 버튼 클릭 시 로그인 화면으로 이동

    ![ezgif com-gif-maker-12](https://user-images.githubusercontent.com/98722435/161370214-4554cc5e-0d58-4926-a12d-faa96ea465e6.gif)
    
    - 게시물 **수정/삭제**는 사용자 아이디를 기준으로 **작성자와 로그인한 사용자의 아이디가 동일한 경우**에만 처리 가능
    - 게시물 **등록/수정/삭제** 후 처리가 정상적으로 되었음을 사용자에게 알리기 위해 **모달창**을 사용

    ![ezgif com-gif-maker-13](https://user-images.githubusercontent.com/98722435/161370329-479962bf-ca7b-46e9-a40c-e094c7e47c3d.gif)

    ![ezgif com-gif-maker-14](https://user-images.githubusercontent.com/98722435/161370564-0f9645b1-e0b6-4562-9e78-5bc050d069d2.gif)


- ##### 2) 게시물 검색
    - 게시판 하단 검색창을 통해 조건에 맞는 게시물 **검색** 가능 
    - 검색 결과로 나온 게시물을 조회한 후 조회 페이지 하단에 있는 ’목록으로’ 버튼 클릭 시 게시판 조회 목록으로 돌아갈 때, **검색 결과**와 **페이지 위치**가 그대로 **유지**

    ![ezgif com-gif-maker-15](https://user-images.githubusercontent.com/98722435/161370742-e336f56e-eaf5-4244-a28f-34a4e34a8edb.gif)

- ##### 3) 게시물 추천, 취소 
    - 게시물 추천 및 취소 기능은 **무한 추천을 방지**하고자 **Ajax 비동기 처리**로 로그인한 회원에 한해 **아이디 당 게시물 1건에 1회**만 추천할 수 있도록 구현  
    - **게시물 추천 DB**의 추천 수가 **게시판 DB**의 추천 수에 **함께 반영**이 될 수 있도록 게시판 서비스 계층의 실행 메서드에 **트랜잭션 처리**  

    ![ezgif com-gif-maker-16](https://user-images.githubusercontent.com/98722435/161370883-781c93fc-7d1e-4d25-9309-0b1057d73359.gif)

    ![ezgif com-gif-maker-17](https://user-images.githubusercontent.com/98722435/161370919-e1ba1bbe-a8b8-4958-ad8a-70bef9faecb0.gif)


#### 4. 댓글 CRUD
- ##### 1) 댓글 조회, 작성, 등록, 수정, 삭제
    - 댓글 **작성/등록**은 **로그인한 회원**만 가능하도록 구현
    - 댓글 **수정/삭제**는 신규 댓글 작성과 달리 댓글이 등록된 위치에서 바로 수정 및 삭제 처리가 가능하도록 **모달창**을 사용 
    - 댓글 **수정/삭제**는 사용자 아이디를 기준으로 **작성자와 로그인한 사용자의 아이디가 동일한 경우**에만 처리 가능하도록 구현 

    ![ezgif com-gif-maker-18](https://user-images.githubusercontent.com/98722435/161371089-b81aae35-1c53-40a7-93b6-4dcb1e2c0b93.gif)


#### 5. 파일 업로드 
- ##### 1) 파일 업로드 경로 내 연/월/일 폴더 생성 
    - 사용자가 업로드한 파일이 서버에 저장될 시 **동일한 이름의 파일이 업로드** 되었을 때 **기존 파일이 사라지는 문제를 해결**하고자 서버 내 파일 업로드 경로에 **‘연/월/일’** 폴더를 생성하여 **업로드 날짜별로 파일을 구분**할 수 있도록 구현 

    <img width="834" alt="스크린샷 2022-04-02 오후 4 09 18" src="https://user-images.githubusercontent.com/98722435/161371519-b38f16f2-3136-48f3-aee5-ef01e86e5d22.png">

- ##### 2) 파일명에 UUID값 추가 

    - java.util.UUID 클래스를 사용하여 사용자가 업로드하는 파일 이름에 **UUID값**을 **추가**하고 **‘_’로 구분**할 수 있도록 설정하여 **같은 날에 동일한 이름으로 업로드 된 파일** 또한 서로 **구분**되어 각각 **저장**될 수 있도록 구현 

    <img width="542" alt="스크린샷 2022-04-02 오후 4 11 09" src="https://user-images.githubusercontent.com/98722435/161371696-e617362e-44ce-4e9f-bcd0-029343c3a79e.png">
   

- ##### 3) 파일 업로드 시 이미지, 일반 파일 처리 
   - 게시물 작성 중 파일 업로드 시 **이미지 파일**의 경우에는 해당 이미지의 **섬네일 이미지**가, **일반 문서**의 경우에는 **일반 문서 이미지**가 파일 첨부란에 나타나도록 구현 
   - 섬네일 이미지 또한 생성 즉시 서버에 저장되어야 하므로 썸네일 이미지의 경우 **원본 이미지와의 파일명 구분**을 위해 **'s_UUID_파일명'**으로 **저장**되도록 구현 

    ![ezgif com-gif-maker-19](https://user-images.githubusercontent.com/98722435/161371470-455c38d6-c84e-4823-be9b-4805ac8ee0a3.gif)

    - 실제 게시물 등록과 함께 첨부 파일이 등록되므로 게시물 등록 시 **첨부 파일 관리 DB**에 첨부 파일 데이터가 **저장**될 수 있도록 **트랜잭션** 처리

    <img width="762" alt="스크린샷 2022-04-02 오후 4 25 28" src="https://user-images.githubusercontent.com/98722435/161372079-4bafe84d-1b0c-4eab-a872-3009c17f108d.png">


- ##### 3) 첨부 파일 조회 시 이미지, 일반 파일 처리 
    -게시물 조회 페이지에서 첨부 파일 클릭 시 **이미지 파일**은 **원본 이미지**가 화면에 출력되고, **일반 파일**은 **원본 파일을 다운로드**할 수 있도록 구현 

    ![ezgif com-gif-maker-20](https://user-images.githubusercontent.com/98722435/161372267-dfe5fd0f-45af-44c0-a200-dccd3460a4c7.gif)

#### 6. 회원 정보 조회
- ##### 1) 회원 정보 조회/수정 
    - 회원 정보 **조회/수정** 페이지 접근 시 현재 로그인한 사용자의 정보를 가져오기 위해 **Authentication 객체**와, **Principal 객체**를 사용
    - 회원 정보 수정 후에는 수정된 정보를 반영하기 위해 **세션**을 **초기화** 하고 다시 로그인할 수 있도록 로그인 페이지로 **redirect** 처리
    - 처리 결과는 **모달창**을 통해 안내하도록 구현 

    ![ezgif com-gif-maker-21](https://user-images.githubusercontent.com/98722435/161373379-7ca99c62-4c77-4bf4-9f39-e18609179442.gif)

- ##### 2) 회원 탈퇴 
    - 회원 정보 **탈퇴** 페이지 접근 시 현재 로그인한 사용자의 정보를 가져오기 위해 **Authentication 객체**와, **Principal 객체**를 사용
    - 회원 탈퇴 후 **자동 로그아웃**이 될 수 있게 **SecurityContextHolder** 클래스의 **clearContext** 메서드를 사용하고 **세션**을 **초기화** 하였으며 홈 페이지로 이동할 수 있도록 **redirect** 처리
    - 처리 결과는 **모달창**을 통해 안내하도록 구현 

    ![ezgif com-gif-maker-22](https://user-images.githubusercontent.com/98722435/161374461-3bc19086-33fe-4758-928f-a05530903111.gif)

#### 7. 관리자 페이지
- ##### 1) 전체 회원 목록 조회, 권한 수정, 강제 탈퇴 
    - **사용자 편의**를 위해 **페이지 이동이나 새 창 없이** 회원 목록 페이지 내에서 **회원 권한 변경** 및 **회원 강제 탈퇴 처리**를 할 수 있도록 구현

    ![ezgif com-gif-maker-23](https://user-images.githubusercontent.com/98722435/161374659-9e3f3aa1-7dc3-40af-9925-ebbcfab1d537.gif)

    ![ezgif com-gif-maker-24](https://user-images.githubusercontent.com/98722435/161374715-1eda4856-a32e-40c5-8a28-2b6f1384e090.gif)

- ##### 2) 주간 현황 및 기간별 현황: 구글 차트 API를 적용
    - 메인 페이지에서 전체 현황 및 주간 신규 게시물 수, 댓글 수, 회원 수 현황을 확인할 수 있도록 구현
    - **사용자 편의**를 위해 주간 신규 게시물 수, 댓글 수, 회원 수 현황 **데이터는 보기 쉽게 시각화** 할 필요성이 있어 **구글 차트 API**를 사용
    - **주간 현황**의 경우 조회 날짜를 기준으로 **지난주**와 **이번주** 데이터를 가지고 와서 사용자가 쉽게 변화 추이를 비교할 수 있도록 구현

    - 기간별 게시물 현황, 기간별 댓글 현황, 기간별 회원 현황 메뉴에서는 **사용자가 직접 날짜를 설정**해 해당 기간 동안의 변화 추이를 볼 수 있도록 구현
    - 조회 기간 날짜 입력은 jQuery의 datepicker 위젯을 사용하여 **사용자가 쉽게 달력을 확인**하여 **날짜를 선택**할 수 있도록 구현 
    - 기간별 현황 데이터는 **사용자가 직접 조회 기간을 설정**하는 것이므로 별도의 ChartMapper를 생성하고 ChartServiceImpl에서 Mapper에서 처리된 **DB**의 결과를 **JSON 타입으로 파싱** 하도록 구현  

    ![ezgif com-gif-maker-2](https://user-images.githubusercontent.com/98722435/161363926-06f6f5b9-f776-4c3f-9572-ebf18498aefd.gif)

    ![R1280x0](https://user-images.githubusercontent.com/98722435/161375054-8619934f-5467-42bf-8935-e0367915db00.png)

